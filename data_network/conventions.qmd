
# Conventions

## Observation period

The observation period has a major impact on study results, particularly on incidence and prevalence calculations [CITE]. For this reason, it is essential to define the observation_period table carefully.

In some databases, such as primary care data or claims data, enrollment (or registration) and disenrollment dates are available. In these cases, it is most accurate to use the registration date as the *observation_period_start_date* and the deregistration date as the *observation_period_end_date*. While multiple observation periods are not recommended, they are permitted.

In other settings—most commonly secondary care databases, registration dates are not available, which makes defining the observation period more challenging. After initial exploration, we recommend the following approach:

- Observation period start date: the date of the first record for a person.
- Observation period end date: the earliest of the following:
  - Date of death
  - A censoring age (commonly 120 years, though this can vary; e.g., pediatric databases may use 18 years)
  - Other censoring events, such as migration out of the study region.

This definition results in a single observation period per person.

If death registry linkage is not available, it may be advisable to censor patients two years after their last recorded event. This highlights the importance of linking your data to mortality records (for example, the Office for National Statistics in the UK).

As part of the study network’s innovation plan, [OmopConstructor]() was developed. It includes the function [builtObservationPeriod()](), which helps generate the *observation_period* table according to these guidelines.

Please get in touch if you have any questions about building your observation periods.

## Index of Multiple Deprivation quintiles

The Index of Multiple Deprivation (IMD) is a valuable metric in research, as it provides a standardized measure of socioeconomic status across geographic areas.

The convention is to map the IMD data in the *observation* table using the concept ID [35812882](https://athena.ohdsi.org/search-terms/terms/35812882). Since this is not a standard concept we will use standard_concept_id = 0 and source_concept_id = 35812882.

The IMD quintile value is stored in the `value_as_number` field using a number between 1 and 5. For the units, we use the concept ID [37524288](https://athena.ohdsi.org/search-terms/terms/37524288), which represents quintiles.

For the observation date:

- If a measurement date is available in the source data, use that date.
- If no measurement date is available (and you have only one IMD record per person), use the individual’s observation_period_start_date.

In studies, if with multiple IMD records per person are present the record closest to the index date will be used.

An example IMD record in the observation table would look like:

::: {style="overflow-x: auto;"}
| ... | `observation_concept_id` | ... | `value_as_number` | ... | `unit_concept_id` | ... | `observation_source_concept_id` | ... |
|--|------|--|------|--|------|--|------|--|
| ...| 0 | ... | 2 | ... | 37524288 | ... | 35812882 | ... |
:::

## Ethnicity

Patient ethnicity is a valuable data element for research, and we encourage you to include ethnicity records in your OMOP CDM instance if available in your source data.

By convention, ethnicity is mapped using the [NHS Ethnic Category](https://athena.ohdsi.org/search-terms/terms?vocabulary=NHS+Ethnic+Category&page=1&pageSize=15&query=) in two places: the *observation* table and the *person* table. This approach accommodates databases that may contain multiple ethnicity records per patient.

**Observation Table**

Ethnicity records should be inserted into the observation table, using the following conventions:
- `observation_date`: use the date of the ethnicity record in the source data. If not available, use the patient’s `observation_period_start_date`.
- `observation_source_concept_id`: use one of the 15 [NHS Ethnic Category](https://athena.ohdsi.org/search-terms/terms?vocabulary=NHS+Ethnic+Category&page=1&pageSize=15&query=) codes.
observation_concept_id: set to 0, since these codes are non-standard concepts.

**Person Table**

Only one ethnicity record per person is allowed in the person table, to be populated as:
- `race_concept_id`: always set to 0, because the NHS Ethnic Category codes are non-standard.
- `race_source_concept_id`: populate with the most common code per person. If two or more codes occur with equal frequency, select the most recent one. If no ethnicity data is available for a person, set `race_source_concept_id` = 0.

# Feedback

We greatly value your feedback. These conventions have been developed through the exploration of multiple datasets, as well as the review of published literature and existing ETL processes. However, they are not rigid rules—adjustments may be necessary depending on the characteristics of your data. If you believe that these standards do not align well with your dataset, please get in touch so we can discuss potential adaptations.
